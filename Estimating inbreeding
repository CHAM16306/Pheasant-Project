
#PCA for rad data
````
install.packages("pcadapt")
library(pcadapt)

path_to_file <-("/Users/aminachabach/Project/vcftools_0.1.13/thinfilter.recode.vcf")
filename <- read.pcadapt(path_to_file, type = "vcf")
x <- pcadapt(input = filename, K = 20) 
plot(x, option = "screeplot", K = 10)

poplist.csv <- read.csv("/Users/aminachabach/Project/pheasantpops2.csv", header=TRUE)
head(poplist.csv)
poplist.names <-poplist.csv[,7]
str(poplist.names)
plot(x, option = "scores", pop = poplist.names)
````


#use pdg spider to convert vcf to STRUCTURE
#read into R
#add .str when making the output file
#Make sure you're in the right directory (go to session and then set directory)
#data converted from structure to genid object

````
phedata <- read.structure("phedata.stru")

How many genotypes are there? 
63

How many markers are there? 
5802

Which column contains labels for genotypes ('0' if absent)? 
1

Which column contains the population factor ('0' if absent)? 
2

Which other optional columns should be read (press 'return' when done)? 
1: 

Which row contains the marker names ('0' if absent)? 
1

Are genotypes coded by a single row (y/n)? 
n

Converting data from a STRUCTURE .stru file to a genind object... 

`````


````
phedata

/// GENIND OBJECT /////////

 // 63 individuals; 5,802 loci; 11,644 alleles; size: 5.9 Mb

 // Basic content
   @tab:  63 x 11644 matrix of allele counts
   @loc.n.all: number of alleles per locus (range: 2-4)
   @loc.fac: locus factor for the 11644 columns of @tab
   @all.names: list of allele names for each locus
   @ploidy: ploidy of each individual  (range: 2-2)
   @type:  codom
   @call: read.structure(file = "phedata.stru")

 // Optional content
   @pop: population of each individual (group size range: 63-63)
   
`````

tab: a matrix of alleles counts (individuals in rows, alleles in columns).
• loc.n.all: the number of alleles in each marker.
• loc.fac: a factor indicating which columns in @tab correspond to which marker.
• all.names: a list of allele names for each locus.
• ploidy: a vector of integer indicating the ploidy of each individual; constant ploidy is
assumed across different loci of a single individual, but different individuals can have
different ploidy.
• type: a character string indicating whether the marker is codominant (codom) or
presence/absence (PA).
• call: the matched call, i.e. command used to create the object.
• pop: (optional) a factor storing group membership of the individuals; when present,
method needing a population information will automatically use this if nothing else is
provided.
• strata: (optional) a data.frame storing hierarchical structure of individuals (see
dedicated tutorial).
• hierarchy: (optional) a formula defining the hierarchical structure of individuals (see
dedicated tutorial).
• other: (optional) a list storing optional information.













